<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="./style.css" type="text/css">
	</head>
	<body>
		<div id="wrap">
			<textarea id="cE-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">h1'welcome'</textarea>
			<div id="cE-results">
				
			</div>
		</div>
		<script src="https://cdn.rawgit.com/beautify-web/js-beautify/master/js/lib/beautify-html.js" type="application/javascript"></script>
		<script src="https://cdn.rawgit.com/zaucy/js-scripts/master/browser-dom/cE/cE.min.js" type="application/javascript"></script>
		<script>
			var inputEl = document.getElementById("cE-input");
			var resultsEl = document.getElementById("cE-results");
			var sourceResultsEl = cE("pre.source");
			var renderResultsEl = cE("div.render");
			resultsEl.appendChild(sourceResultsEl);
			resultsEl.appendChild(renderResultsEl);
			
			var bAdjustHeight = false;
			
			window.addEventListener("keydown", function(e) {
				
				if(document.activeElement.id == inputEl.id) {
					if(e.which == 9) {
						e.preventDefault();
						inputEl.value += '\t';
					}
				}
			});
			
			function updateResult() {
				try {
					var els = cE(inputEl.value);
					var src = "";
					renderResultsEl.innerHTML = "";
					sourceResultsEl.innerHTML = "";
					if(!els.nodeType) {
						for(var n=0; els.length > n; n++) {
							var el = els[n];
							src += el.outerHTML;
							renderResultsEl.appendChild(el);
						}
					} else {
						src = els.outerHTML;
						renderResultsEl.appendChild(els);
					}
					
					sourceResultsEl.textContent = html_beautify(src);
					inputEl.classList.remove('error');
				} catch(err) {
					inputEl.classList.add('error');
				}
			}
			
			updateResult();
			
			inputEl.addEventListener("input", function() {
				updateResult();
				inputEl.style.height = inputEl.scrollHeight - 20 + "px";
			});
		</script>
	</body>
</html>